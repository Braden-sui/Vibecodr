name = "vibecodr-api"
main = "./src/index.ts"
compatibility_date = "2024-10-01"

[[d1_databases]]
binding = "DB"
database_name = "vibecodr-d1"
database_id = "1d42e343-b1a3-4371-a4a3-516381599bc2"
migrations_dir = "drizzle/migrations"

[[r2_buckets]]
binding = "R2"
bucket_name = "vibecodr-assets"

[assets]
# Keep assets directory local and minimal to avoid scanning unrelated paths
directory = "./assets"

[vars]
ALLOWLIST_HOSTS = "[]" # JSON array of allowed network hosts per capsule is enforced per-request
CLERK_JWT_ISSUER = "https://talented-stag-53.clerk.accounts.dev"
# Optional: comma-separated audiences (https origins or app identifiers) to require on Clerk tokens
CLERK_JWT_AUDIENCE = ""

# Durable Objects binding for BuildCoordinator
[durable_objects]
bindings = [
  { name = "BUILD_COORDINATOR_DURABLE", class_name = "BuildCoordinator" }
]

# Durable Objects migration tag
[[migrations]]
tag = "2025-11-12_build_coordinator"
new_sqlite_classes = ["BuildCoordinator"]

# Workers Analytics Engine dataset binding
[[analytics_engine_datasets]]
binding = "vibecodr_analytics_engine"
dataset = "vibecodr_analytics"
